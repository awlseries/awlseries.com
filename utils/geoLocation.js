import axios from 'axios';

export const getRegionByIP = async () => {
  try {
    // Используем бесплатный API для определения местоположения
    const response = await axios.get('https://ipapi.co/json/');
    const data = response.data;
    
    // Определяем регион по континенту или стране
    const country = data.country_code;
    const continent = data.continent_code;
    
    // Маппинг стран и континентов к нашим регионам
    const regionMap = {
      // Европа
      'EU': 'Европа',
      // Европейские страны
      'DE': 'Европа', // Германия
      'FR': 'Европа', // Франция
      'GB': 'Европа', // Великобритания
      'IT': 'Европа', // Италия
      'ES': 'Европа', // Испания
      'NL': 'Европа', // Нидерланды
      'BE': 'Европа', // Бельгия
      'PT': 'Европа', // Португалия
      'SE': 'Европа', // Швеция
      'NO': 'Европа', // Норвегия
      'FI': 'Европа', // Финляндия
      'DK': 'Европа', // Дания
      'PL': 'Европа', // Польша
      'CZ': 'Европа', // Чехия
      'SK': 'Европа', // Словакия
      'HU': 'Европа', // Венгрия
      'AT': 'Европа', // Австрия
      'CH': 'Европа', // Швейцария
      'IE': 'Европа', // Ирландия
      'GR': 'Европа', // Греция
      'RO': 'Европа', // Румыния
      'BG': 'Европа', // Болгария
      'HR': 'Европа', // Хорватия
      'SI': 'Европа', // Словения
      'EE': 'Европа', // Эстония
      'LV': 'Европа', // Латвия
      'LT': 'Европа', // Литва
      'LU': 'Европа', // Люксембург
      'MT': 'Европа', // Мальта
      'CY': 'Европа', // Кипр
      'IS': 'Европа', // Исландия
      'AL': 'Европа', // Албания
      'MK': 'Европа', // Северная Македония
      'ME': 'Европа', // Черногория
      'RS': 'Европа', // Сербия
      'BA': 'Европа', // Босния и Герцеговина
      'UA': 'Европа', // Украина
      'BY': 'Европа', // Беларусь
      'MD': 'Европа', // Молдова
      
      // Азия
      'AS': 'Азия',
      'CN': 'Азия', // Китай
      'JP': 'Азия', // Япония
      'KR': 'Азия', // Южная Корея
      'KP': 'Азия', // Северная Корея
      'IN': 'Азия', // Индия
      'ID': 'Азия', // Индонезия
      'TH': 'Азия', // Таиланд
      'VN': 'Азия', // Вьетнам
      'MY': 'Азия', // Малайзия
      'PH': 'Азия', // Филиппины
      'SG': 'Азия', // Сингапур
      'BD': 'Азия', // Бангладеш
      'PK': 'Азия', // Пакистан
      'LK': 'Азия', // Шри-Ланка
      'NP': 'Азия', // Непал
      'MM': 'Азия', // Мьянма
      'KH': 'Азия', // Камбоджа
      'LA': 'Азия', // Лаос
      'MN': 'Азия', // Монголия
      'TW': 'Азия', // Тайвань
      'HK': 'Азия', // Гонконг
      'MO': 'Азия', // Макао
      'BN': 'Азия', // Бруней
      'TL': 'Азия', // Восточный Тимор
      'MV': 'Азия', // Мальдивы
      'BT': 'Азия', // Бутан
      
      // Ближний Восток (относим к Азии)
      'SA': 'Азия', // Саудовская Аравия
      'AE': 'Азия', // ОАЭ
      'QA': 'Азия', // Катар
      'KW': 'Азия', // Кувейт
      'OM': 'Азия', // Оман
      'BH': 'Азия', // Бахрейн
      'TR': 'Азия', // Турция
      'IR': 'Азия', // Иран
      'IQ': 'Азия', // Ирак
      'SY': 'Азия', // Сирия
      'JO': 'Азия', // Иордания
      'LB': 'Азия', // Ливан
      'IL': 'Азия', // Израиль
      'PS': 'Азия', // Палестина
      'YE': 'Азия', // Йемен
      
      // Евразия (Россия, Казахстан, Азербайджан, Грузия)
      'RU': 'Евразия', // Россия
      'KZ': 'Евразия', // Казахстан
      'AZ': 'Евразия', // Азербайджан
      'GE': 'Евразия', // Грузия
      'AM': 'Евразия', // Армения
      'KG': 'Евразия', // Киргизия
      'UZ': 'Евразия', // Узбекистан
      'TM': 'Евразия', // Туркменистан
      'TJ': 'Евразия', // Таджикистан
      
      // Африка
      'AF': 'Африка',
      'ZA': 'Африка', // Южная Африка
      'NG': 'Африка', // Нигерия
      'EG': 'Африка', // Египет
      'ET': 'Африка', // Эфиопия
      'KE': 'Африка', // Кения
      'GH': 'Африка', // Гана
      'TZ': 'Африка', // Танзания
      'DZ': 'Африка', // Алжир
      'MA': 'Африка', // Марокко
      'SD': 'Африка', // Судан
      'UG': 'Африка', // Уганда
      'CD': 'Африка', // ДР Конго
      'AO': 'Африка', // Ангола
      'MZ': 'Африка', // Мозамбик
      'CM': 'Африка', // Камерун
      'CI': 'Африка', // Кот-д'Ивуар
      'MG': 'Африка', // Мадагаскар
      'SN': 'Африка', // Сенегал
      'ZW': 'Африка', // Зимбабве
      'TN': 'Африка', // Тунис
      'LY': 'Африка', // Ливия
      'ZM': 'Африка', // Замбия
      'RW': 'Африка', // Руанда
      'BJ': 'Африка', // Бенин
      'BF': 'Африка', // Буркина-Фасо
      'ML': 'Африка', // Мали
      'NE': 'Африка', // Нигер
      'TG': 'Африка', // Того
      
      // Америка
      'NA': 'Америка', // Северная Америка
      'SA': 'Америка', // Южная Америка
      'US': 'Америка', // США
      'CA': 'Америка', // Канада
      'MX': 'Америка', // Мексика
      'BR': 'Америка', // Бразилия
      'AR': 'Америка', // Аргентина
      'CO': 'Америка', // Колумбия
      'PE': 'Америка', // Перу
      'VE': 'Америка', // Венесуэла
      'CL': 'Америка', // Чили
      'EC': 'Америка', // Эквадор
      'GT': 'Америка', // Гватемала
      'CU': 'Америка', // Куба
      'BO': 'Америка', // Боливия
      'DO': 'Америка', // Доминикана
      'HN': 'Америка', // Гондурас
      'PY': 'Америка', // Парагвай
      'SV': 'Америка', // Сальвадор
      'NI': 'Америка', // Никарагуа
      'CR': 'Америка', // Коста-Рика
      'PR': 'Америка', // Пуэрто-Рико
      'PA': 'Америка', // Панама
      'UY': 'Америка', // Уругвай
      'JM': 'Америка', // Ямайка
      'TT': 'Америка', // Тринидад и Тобаго
      
      // Австралия и Океания
      'OC': 'Австралия',
      'AU': 'Австралия', // Австралия
      'NZ': 'Австралия', // Новая Зеландия
      'PG': 'Австралия', // Папуа - Новая Гвинея
      'FJ': 'Австралия', // Фиджи
      'SB': 'Австралия', // Соломоновы Острова
      'VU': 'Австралия', // Вануату
      'NC': 'Австралия', // Новая Каледония
      'PF': 'Австралия', // Французская Полинезия
      'WS': 'Австралия', // Самоа
      'TO': 'Австралия', // Тонга
    };
    
    // Сначала проверяем по стране, потом по континенту
    const region = regionMap[country] || regionMap[continent] || 'Европа';
    
    return region;
    
  } catch (error) {
    console.error('Ошибка определения региона:', error);
    return 'Европа'; // Регион по умолчанию
  }
};